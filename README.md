# Прогноз поведения пользователей

Этот проект реализует гибридную нейросетевую модель для предсказания почасовой активности пользователей.
Модель сочетает в себе **LSTM** (для анализа временных зависимостей) и **Linear Trend** (для учета текущего состояния признаков).

## Метрики после оптимизации
- **R^2:** ~0.7883 - модель успешно выучила структуру данных
- **MAPE** (в %): ~4.06 - прогноз отклоняется всего на 4% от реальности
- **MAE:** ~7.14 - средняя ошибка составляет около 7 пользователей

## Архитектура
Модель `HybridForecaster` состоит из:
1. **LSTM-блока**: анализирует окно в 24 часа
2. **Trend-блока**: полносвязный слой, принимающий фичи последнего шага (лаги 1ч, 24ч, 48ч, час, день недели)
3. **Суммирующего выхода**: объединяет нелинейный прогноз и линейный тренд

## Управление проектом 

Выполняем следующие команды для работы:

### 1. Установка всех зависимостей

```bash
  pip install -r requirements.txt
```

### 2. Генерация синтетических данных

```bash
  python generate_data.py
```

### 3. Далее анализ и создание features.csv в блокноте №1


### 4. Обучение модели с логированием в MLflow

```bash
  python run.py
```
* После этого шага появится сохранённая модель и можно будет зайти в блокнот №2 и просмотреть визуализацию

### 5. Запуск интерфейса MLflow для просмотра лоссов

```bash
  mlflow ui
```